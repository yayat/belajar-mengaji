import React, { useState } from 'react';
import { BookOpen, ChevronRight, PlayCircle } from 'lucide-react';
import { playTextToSpeech } from '@/utils/audio';

const Iqro = () => {
    const [level, setLevel] = useState(1);
    const [page, setPage] = useState(1);
    const [playingChar, setPlayingChar] = useState(null);

    const handlePlayChar = (text, lineIdx, charIdx) => {
        if (playingChar) return; // Prevent overlapping

        setPlayingChar({ line: lineIdx, char: charIdx });
        playTextToSpeech(
            text,
            () => setPlayingChar(null),
            () => setPlayingChar(null)
        );
    };

    const levels = [1, 2, 3, 4, 5, 6];

    // Data Structure for Iqro Content
    const iqroContents = {
        1: [
            // Page 1: A - Ba
            [
                ["اَ", "اَ", "اَ"],
                ["بَ", "بَ", "بَ"],
                ["اَ", "بَ", "اَ"],
                ["بَ", "اَ", "بَ"],
                ["اَ", "بَ", "اَ", "بَ"]
            ],
            // Page 2: Ba - Ta
            [
                ["بَ", "تَ", "بَ"],
                ["تَ", "بَ", "تَ"],
                ["اَ", "بَ", "تَ"],
                ["بَ", "تَ", "اَ"],
                ["تَ", "اَ", "بَ"]
            ],
            // Page 3: Ta - Tsa
            [
                ["تَ", "ثَ", "تَ"],
                ["ثَ", "تَ", "ثَ"],
                ["بَ", "تَ", "ثَ"],
                ["ثَ", "بَ", "اَ"],
                ["تَ", "اَ", "ثَ"]
            ],
            // Page 4: Ja - Ha
            [
                ["جَ", "حَ", "جَ"],
                ["حَ", "جَ", "حَ"],
                ["اَ", "جَ", "جَ"],
                ["حَ", "ثَ", "تَ"],
                ["جَ", "بَ", "خَ"] // Intentional mix, but technically Kho is next page. Let's keep it simple.
                // Re-aligning to standard Iqro progression which introduces letters in small groups
            ],
            // Page 5: Ja - Ha - Kho
            [
                ["جَ", "حَ", "خَ"],
                ["خَ", "حَ", "جَ"],
                ["حَ", "اَ", "خَ"],
                ["جَ", "تَ", "خَ"],
                ["ثَ", "بَ", "جَ"]
            ],
            // Page 6: Da - Dza
            [
                ["دَ", "ذَ", "دَ"],
                ["ذَ", "دَ", "ذَ"],
                ["خَ", "دَ", "ذَ"],
                ["حَ", "ذَ", "اَ"],
                ["جَ", "دَ", "حَ"]
            ],
            // Page 7: Ro - Zai
            [
                ["رَ", "زَ", "رَ"],
                ["زَ", "رَ", "زَ"],
                ["دَ", "ذَ", "رَ", "زَ"],
                ["خَ", "زَ", "دَ"],
                ["حَ", "رَ", "ذَ"]
            ],
            // Page 8: Sa - Sya
            [
                ["سَ", "شَ", "سَ"],
                ["شَ", "سَ", "شَ"],
                ["سَ", "اَ", "شَ"],
                ["زَ", "سَ", "شَ"],
                ["رَ", "شَ", "ذَ"]
            ],
            // Page 9: Sho - Dho
            [
                ["صَ", "ضَ", "صَ"],
                ["ضَ", "صَ", "ضَ"],
                ["شَ", "صَ", "ضَ"],
                ["سَ", "ضَ", "زَ"],
                ["خَ", "صَ", "ضَ"]
            ],
            // Page 10: Tho - Zho
            [
                ["طَ", "ظَ", "طَ"],
                ["ظَ", "طَ", "ظَ"],
                ["طَ", "اَ", "ظَ"],
                ["ضَ", "طَ", "زَ"],
                ["صَ", "ظَ", "ثَ"]
            ],
            // Page 11: 'Ain - Ghain
            [
                ["عَ", "غَ", "عَ"],
                ["غَ", "عَ", "غَ"],
                ["عَ", "ضَ", "غَ"],
                ["ظَ", "غَ", "طَ"],
                ["عَ", "خَ", "غَ"]
            ],
            // Page 12: Fa - Qof
            [
                ["فَ", "قَ", "فَ"],
                ["قَ", "فَ", "قَ"],
                ["فَ", "عَ", "قَ"],
                ["غَ", "فَ", "ظَ"],
                ["قَ", "طَ", "فَ"]
            ],
            // Page 13: Ka - La
            [
                ["كَ", "لَ", "كَ"],
                ["لَ", "كَ", "لَ"],
                ["قَ", "كَ", "لَ"],
                ["فَ", "لَ", "قَ"],
                ["كَ", "بَ", "لَ"]
            ],
            // Page 14: Ma - Na
            [
                ["مَ", "نَ", "مَ"],
                ["نَ", "مَ", "نَ"],
                ["لَ", "مَ", "نَ"],
                ["كَ", "نَ", "مَ"],
                ["قَ", "مَ", "لَ"]
            ],
            // Page 15: Wa - Ha
            [
                ["وَ", "هـَ", "وَ"],
                ["هـَ", "وَ", "هـَ"],
                ["مَ", "وَ", "هـَ"],
                ["نَ", "هـَ", "وَ"],
                ["لَ", "وَ", "كَ"]
            ],
            // Page 16: Ya (Final)
            [
                ["يَ", "يَ", "يَ"],
                ["اَ", "بَ", "تَ", "ثَ"],
                ["جَ", "حَ", "خَ", "دَ"],
                ["ذَ", "رَ", "زَ", "سَ"],
                ["شَ", "صَ", "ضَ", "طَ"],
                ["ظَ", "عَ", "غَ", "فَ"],
                ["قَ", "كَ", "لَ", "مَ"],
                ["نَ", "وَ", "هـَ", "يَ"]
            ]
        ],
        2: [
            // Page 1: Ba-Ta, Ta-Ba (Sambung)
            [
                ["بَتَ", "تَبَ", "بَتَ"],
                ["تَبَ", "بَتَ", "تَبَ"],
                ["بَا", "تَا", "بَتَا"],
                ["تَابَ", "بَاتَ", "تَبَا"]
            ],
            // Page 2: Ta-Na, Na-Ba
            [
                ["تَنَ", "نَبَ", "بَنَ"],
                ["نَتَ", "بَنَ", "نَبَ"],
                ["نَبَا", "بَنَا", "تَنَا"],
                ["بَيَنَ", "نَيَتَ", "تَيَبَ"]
            ],
            // Page 3: Ya-Ta, Na-Ya
            [
                ["يَتَ", "نَيَ", "يَنَ"],
                ["تَيَ", "بَيَ", "نَيَ"],
                ["يَتَنَ", "نَبَيَ", "يَتَبَ"],
                ["بَيَنَ", "نَيَتَ", "تَيَبَ"]
            ],
            // Page 4: Ja-La, Sa-La
            [
                ["جَلَ", "لَجَ", "سَلَ"],
                ["لَسَ", "جَسَ", "لَجَ"],
                ["جَلَ", "سَجَ", "لَسَ"],
                ["جَلَسَ", "سَجَلَ", "لَجَسَ"]
            ],
            // Page 5: Ma-Na, La-Ma
            [
                ["مَنَ", "نَمَ", "لَمَ"],
                ["مَلَ", "لَنَ", "نَمَ"],
                ["عَلِمَ", "عَمِلَ", "لَمَعَ"],
                ["مَنَعَ", "نَفَعَ", "جَمَعَ"]
            ],
            // Page 6: Ba-Ro, Ro-Ta
            [
                ["بَرَ", "رَبَ", "تَرَ"],
                ["رَتَ", "بَرَتَ", "تَرَبَ"],
                ["رَجَعَ", "جَرَحَ", "خَرَجَ"],
                ["تَرَكَ", "بَرَكَ", "رَكَبَ"]
            ],
            // Page 7: Sa-Ma, Sya-Ma
            [
                ["سَمَ", "مَسَ", "شَمَ"],
                ["مَشَ", "سَمِعَ", "شَمِسَ"],
                ["حَسَدَ", "سَجَدَ", "جَلَسَ"],
                ["بَسَطَ", "نَشَطَ", "شَطَرَ"]
            ],
            // Page 8: Fa-Qo, Qa-La
            [
                ["فَقَ", "قَفَ", "قَلَ"],
                ["لَقَ", "فَعَلَ", "قَتَلَ"],
                ["خَلَقَ", "فَلَقَ", "قَفَلَ"],
                ["وَقَفَ", "سَقَفَ", "لَقَفَ"]
            ],
            // Page 9: Ka-La, Ma-Ka
            [
                ["كَلَ", "لَكَ", "مَكَ"],
                ["كَمَ", "كَتَبَ", "مَكَرَ"],
                ["حَكَمَ", "شَكَرَ", "كَفَرَ"],
                ["تَرَكَ", "هَلَكَ", "مَلَكَ"]
            ],
            // Page 10: Ha-Ya, Na-Ha
            [
                ["هَيَ", "يَهَ", "نَهَ"],
                ["هَنَ", "وَهَبَ", "ذَهَبَ"],
                ["يَدَكَ", "لَهَبَ", "نَهَرَ"],
                ["جَهَرَ", "ظَهَرَ", "طَهَرَ"]
            ],
            // Page 11: Sambung 3 Huruf (Review)
            [
                ["كَتَبَ", "نَظَرَ", "جَلَسَ"],
                ["ذَهَبَ", "رَجَعَ", "حَضَرَ"],
                ["سَأَلَ", "قَرَأَ", "بَدَأَ"],
                ["خَلَقَ", "رَزَقَ", "صَدَقَ"]
            ],
            // Page 12: Mad Thabi'i (Alif) Intro
            [
                ["بَ", "بَا", "تَ", "تَا"],
                ["نَ", "نَا", "يَ", "يَا"],
                ["جَ", "جَا", "حَ", "حَا"],
                ["خَ", "خَا", "دَ", "دَا"]
            ],
            // Page 13: Mad Thabi'i Practice 1
            [
                ["كَا", "كَ", "لَا", "لَ"],
                ["مَا", "مَ", "نَا", "نَ"],
                ["وَ", "وَا", "هَـ", "هَـا"],
                ["يَا", "a", "ءَا", "ءَ"]
            ],
            // Page 14: Mad Thabi'i Practice 2
            [
                ["زَادَ", "زَعَمَ", "تَابَ"],
                ["خَافَ", "حَالَ", "صَامَ"],
                ["كَانَ", "قَالَ", "مَالَ"],
                ["نَارَ", "فَازَ", "جَاءَ"]
            ],
            // Page 15: Mad Thabi'i Mixed
            [
                ["هَاجَرَ", "جَاهَدَ", "سَافَرَ"],
                ["شَاهَدَ", "عَاهَدَ", "بَارَكَ"],
                ["تَبَارَكَ", "تَعَالَى", "نَادَى"],
                ["مَاكِثِينَ", "خَالِدِينَ", "شَاكِرِينَ"]
            ]
        ],
        3: [
            // Page 1: Kasrah (Intro)
            [
                ["اِ", "بِ", "تِ", "ثِ"],
                ["جِ", "حِ", "خِ", "دِ"],
                ["ذِ", "رِ", "زِ", "سِ"],
                ["شِ", "صِ", "ضِ", "طِ"]
            ],
            // Page 2: Kasrah (Words)
            [
                ["عَلِمَ", "عَمِلَ", "ضَحِكَ"],
                ["حَمِدَ", "شَهِدَ", "رَحِمَ"],
                ["مَلِكِ", "اَبَتِ", "كُتِبَ"],
                ["بَخِلَ", "سَخِرَ", "لَعِبَ"]
            ],
            // Page 3: Dhommah (Intro)
            [
                ["اُ", "بُ", "تُ", "ثُ"],
                ["جُ", "حُ", "خُ", "دُ"],
                ["ذُ", "رُ", "زُ", "سُ"],
                ["شُ", "صُ", "ضُ", "طُ"]
            ],
            // Page 4: Dhommah (Words)
            [
                ["رُسُلُ", "سُبُلُ", "اُكُلُ"],
                ["نُزُلُ", "كُتُبُ", "حُرُمُ"],
                ["خُلِقَ", "ضُرِبَ", "قُتِلَ"],
                ["ظُلِمَ", "سُئِلَ", "قُرِئَ"]
            ],
            // Page 5: Mix Fathah, Kasrah, Dhommah
            [
                ["جُعِلَ", "ذُكِرَ", "خُبِزَ"],
                ["فُتِحَ", "نُصِرَ", "غُفِرَ"],
                ["كَبُرَ", "كَثُرَ", "حَسُنَ"],
                ["عَظُمَ", "كَرُمَ", "شَرُفَ"]
            ],
            // Page 6: Mad Thabi'i Kasrah (Ya Sukun) Intro
            [
                ["بِ", "بِي", "تِ", "تِي"],
                ["جِ", "جِي", "دِ", "دِي"],
                ["رِ", "رِي", "سِ", "سِي"],
                ["قِيلَ", "فِيهِ", "دِينِي"]
            ],
            // Page 7: Mad Thabi'i Kasrah Practice
            [
                ["سَبِيلِي", "رَسُولِي", "كِتَابِي"],
                ["حَدِيثِي", "نَعِيمِي", "كَرِيمِي"],
                ["بَصِيرِي", "عَلِيمِي", "حَكِيمِي"],
                ["فِي", "جِيدِهَا", "أَبِيهَا"]
            ],
            // Page 8: Mad Thabi'i Dhommah (Wau Sukun) Intro
            [
                ["بُ", "بُو", "تُ", "تُو"],
                ["جُ", "جُو", "دُ", "دُو"],
                ["رُ", "رُو", "سُ", "سُو"],
                ["يَقُولُ", "يَتُوبُ", "يَكُونُ"]
            ],
            // Page 9: Mad Thabi'i Dhommah Practice
            [
                ["غَفُورُ", "شَكُورُ", "صَبُورُ"],
                ["يَقُومُ", "يَصُومُ", "يَدُومُ"],
                ["أَعُوذُ", "نَعُوذُ", "تَمُوتُ"],
                ["بُيُوتُ", "قُلُوبُ", "جُلُودُ"]
            ],
            // Page 10: Mixed Mad Words
            [
                ["يُرِيدُ", "يُعِيدُ", "يُبْدِئُ"],
                ["رَسُولُ", "سَبِيلُ", "بَصِيرُ"],
                ["عَذَابِي", "عِقَابِي", "مَآبِي"],
                ["تَمَاثِيلُ", "مَقَادِيرُ", "قَوَارِيرُ"]
            ],
            // Page 11: Panjang Pendek Variations 1
            [
                ["اُوتِيَ", "اُوذِيَ", "اُوفِيَ"],
                ["نُودِيَ", "عُوفِيَ", "هُدِيَ"],
                ["يَمُوتُونَ", "يَقُولُونَ", "يَتُوبُونَ"],
                ["خَالِدُونَ", "رَاكِعُونَ", "سَاجِدُونَ"]
            ],
            // Page 12: Panjang Pendek Variations 2
            [
                ["هَا", "هَذَا", "هَذِهِ"],
                ["إِلَٰهَ", "إِلَٰهِي", "يَلْهَثْ"],
                ["سْمَوَاتِ", "حَيَاةِ", "صَلَاةِ"],
                ["زَكَاةِ", "تُقَاةِ", "غَدَاةِ"]
            ],
            // Page 13: Review Sentence 1
            [
                ["لَكُم", "دِينُكُم", "وَلِيَ", "دِينِ"],
                ["قُل", "يَا", "أَيُّهَا", "الْكَافِرُونَ"],
                ["لَا", "أَعْبُدُ", "مَا", "تَعْبُدُونَ"],
                ["وَلَا", "أَنتُم", "عَابِدُونَ", "مَا", "أَعْبُدُ"]
            ],
            // Page 14: Review Sentence 2
            [
                ["إِذَا", "جَاءَ", "نَصْرُ", "اللَّهِ", "وَالْفَتْحُ"],
                ["وَرَأَيْتَ", "النَّاسَ", "يَدْخُلُونَ"],
                ["فِي", "دِينِ", "اللَّهِ", "أَفْوَاجًا"],
                ["فَسَبِّحْ", "بِحَمْدِ", "رَبِّكَ", "وَاسْتَغْفِرْهُ"]
            ]
        ],
        4: [
            // Page 1: Fathatain (an)
            [
                ["اً", "بً", "تً", "ثً"],
                ["جً", "حً", "خً", "دً"],
                ["ذً", "رً", "زً", "سً"],
                ["عَلِيمًا", "حَكِيمًا", "غَفُورًا"]
            ],
            // Page 2: Kasratain (in)
            [
                ["اٍ", "بٍ", "تٍ", "ثٍ"],
                ["جٍ", "حٍ", "خٍ", "دٍ"],
                ["عَمَدٍ", "أَحَدٍ", "بَلَدٍ"],
                ["بِقَدَرٍ", "كَلِمَاتٍ", "نَفْسٍ"]
            ],
            // Page 3: Dhommatain (un)
            [
                ["اٌ", "بٌ", "تٌ", "ثٌ"],
                ["جٌ", "حٌ", "خٌ", "دٌ"],
                ["سَمِيعٌ", "بَصِيرٌ", "عَلِيمٌ"],
                ["كِتَابٌ", "مُبِينٌ", "رَسُولٌ"]
            ],
            // Page 4: Mixed Tanwin
            [
                ["كُفُوًا", "أَحَدٌ", "لَهَبٍ"],
                ["مَسَدٍ", "غَاسِقٍ", "وَقَبَ"],
                ["حَاسِدٍ", "إِذَا", "حَسَدَ"],
                ["وَلَدٌ", "وَوَالِدٍ", "بَلَدًا"]
            ],
            // Page 5: Sukun Intro (Simple)
            [
                ["يَدْ", "تُبْ", "خُذْ", "كُلْ"],
                ["قُمْ", "نَمْ", "قُلْ", "كُنْ"],
                ["اَنْ", "لَنْ", "مَنْ", "عَنْ"],
                ["كَيْ", "لَوْ", "أَوْ", "لَيْ"]
            ],
            // Page 6: Sukun 'L', 'M', 'R'
            [
                ["اَلْحَمْدُ", "أَنْعَمْتَ", "يَلْعَبُ"],
                ["يَعْمَلُ", "تَرْضَى", "يَرْجِعُ"],
                ["أَرْسَلَ", "أَمْهِلْ", "فَأَكْرَمَهُ"],
                ["وَالْفَجْرِ", "وَلَيَالٍ", "عَشْرٍ"]
            ],
            // Page 7: Qalqalah (B, J, D, To, Qof)
            [
                ["اَبْ", "اَجْ", "اَدْ", "اَطْ", "اَقْ"],
                ["يَقْبَلُ", "يَجْعَلُ", "يَدْخُلُ"],
                ["يَطْمَعُ", "يَقْتُلُ", "نُطْفَةٍ"],
                ["حَبْلٌ", "سُبْحَانَ", "أَدْبَارَ"]
            ],
            // Page 8: Hams (Sukun T, K, S, F)
            [
                ["اَتْ", "اَكْ", "اَسْ", "اَفْ"],
                ["فَتْحٌ", "تَكْبِيرٌ", "يَكْسِبُ"],
                ["يُوَسْوِسُ", "نَفْسٍ", "اُقْسِمُ"],
                ["رِزْقًا", "شُكْرًا", "ذِكْرًا"]
            ],
            // Page 9: Practice 'H', 'Kh', 'Gh', 'Ain Sukun
            [
                ["اَهْ", "اَحْ", "اَخْ", "اَعْ", "اَغْ"],
                ["يَهْدِي", "يَحْسَبُ", "يَخْلُقُ"],
                ["يَعْلَمُ", "يَغْفِرُ", "اَفْرِغْ"],
                ["عَهْدًا", "وَعْدًا", "يَخْشَى"]
            ],
            // Page 10: Mixed Sukun Words
            [
                ["مُسْلِمُونَ", "مُؤْمِنُونَ", "مُجْرِمُونَ"],
                ["يَسْتَغْفِرُ", "يَسْتَكْبِرُ", "مُسْتَقِيمٍ"],
                ["وَلْيَتَلَطَّفْ", "فَلْيَعْبُدُوا", "أَطْعَمَهُم"],
                ["مِنْهُم", "عَلَيْهِم", "إِلَيْهِم"]
            ],
            // Page 11: Sentence Practice 1
            [
                ["لِإِيلَافِ", "قُرَيْشٍ", "إِيلَافِهِمْ"],
                ["رِحْلَةَ", "الشِّتَاءِ", "وَالصَّيْفِ"],
                ["فَلْيَعْبُدُوا", "رَبَّ", "هَذَا", "الْبَيْتِ"],
                ["الَّذِي", "أَطْعَمَهُم", "مِن", "جُوعٍ"]
            ],
            // Page 12: Sentence Practice 2
            [
                ["أَلَمْ", "تَرَ", "كَيْفَ", "فَعَلَ"],
                ["رَبُّكَ", "بِأَصْحَابِ", "الْفِيلِ"],
                ["أَلَمْ", "يَجْعَلْ", "كَيْدَهُمْ", "فِي", "تَضْلِيلٍ"],
                ["وَأَرْسَلَ", "عَلَيْهِمْ", "طَيْرًا", "أَبَابِيلَ"]
            ]
        ],
        5: [
            // Page 1: Tasydid (Intro)
            [
                ["اَبَّ", "اَبِّ", "اَبُّ"],
                ["اَجَّ", "اَجِّ", "اَجُّ"],
                ["رَبَّ", "حَقَّ", "مَدَّ"],
                ["حَجَّ", "شَقَّ", "تَبَّ"]
            ],
            // Page 2: Tasydid Words
            [
                ["كَذَّبَ", "يُكَذِّبُ", "رَتَّلَ", "يُرَتِّلُ"],
                ["عَلَّمَ", "يُعَلِّمُ", "بَشَّرَ", "يُبَشِّرُ"],
                ["سَبَّحَ", "يُسَبِّحُ", "قَدَّرَ", "يُقَدِّرُ"],
                ["صَدَّقَ", "يُصَدِّقُ", "حَقَّقَ", "يُحَقِّقُ"]
            ],
            // Page 3: Tasydid + Mad
            [
                ["وَالضُّحَى", "وَاللَّيْلِ", "سَجَى"],
                ["وَلَا", "الضَّالِّينَ", "دَابَةٍ"],
                ["الصَّاخَةُ", "الطَّامَّةُ", "الْحَاقَّةُ"],
                ["أَتُحَاجُّونِّي", "وَمَحْيَايَ", "وَمَمَاتِي"]
            ],
            // Page 4: Ghunnah (Nun/Mim Tasydid)
            [
                ["اِنَّ", "اَنَّ", "كَاَنَّ"],
                ["ثُمَّ", "اَمَّا", "فَلَمَّا"],
                ["اِنَّهُ", "لَكِنَّ", "جَهَنَّمَ"],
                ["عَمَّ", "مِمَّا", "اُمَّةٍ"]
            ],
            // Page 5: Ghunnah Practice
            [
                ["قُلْ", "أَعُوذُ", "بِرَبِّ", "النَّاسِ"],
                ["مَلِكِ", "النَّاسِ", "إِلَٰهِ", "النَّاسِ"],
                ["مِن", "شَرِّ", "الْوَسْوَاسِ", "الْخَنَّاسِ"],
                ["الَّذِي", "يُوَسْوِسُ", "فِي", "صُدُورِ"]
            ],
            // Page 6: Alif Lam Qomariyah (Jelas)
            [
                ["اَلْحَمْدُ", "اَلْكِتَابُ", "اَلْعَالَمِينَ"],
                ["اَلْقَارِعَةُ", "اَلْحَاقَّةُ", "اَلْغَاشِيَةُ"],
                ["اَلْمَغْضُوبِ", "اَلْأَرْضِ", "اَلْيَقِينِ"],
                ["خَلَقَ", "الْإِنسَانَ", "مِنْ", "عَلَقٍ"]
            ],
            // Page 7: Alif Lam Syamsiyah (Leubur)
            [
                ["وَالشَّمْسِ", "وَالضُّحَى", "وَالتِّينِ"],
                ["وَالنَّهَارِ", "وَالسَّمَاءِ", "وَالنَّجْمِ"],
                ["الرَّحْمَٰنِ", "الرَّحِيمِ", "الدِّينِ"],
                ["الصِّرَاطَ", "الْمُسْتَقِيمَ", "الذِّكْرَ"]
            ],
            // Page 8: Lafzul Jalalah (Allah)
            [
                ["اَللّٰهُ", "وَاللّٰهُ", "بِاللّٰهِ"],
                ["رَسُولُ اللَّهِ", "سُبْحَانَ اللَّهِ", "نَصْرُ اللَّهِ"],
                ["لِلَّهِ", "بِإِذْنِ اللَّهِ", "أَمْرُ اللَّهِ"],
                ["قُلْ", "هُوَ", "اللَّهُ", "أَحَدٌ"]
            ],
            // Page 9: Qalqalah Sugra & Kubra Practice
            [
                ["يَجْعَلْ", "خَلَقَ", "مُحِيطٌ"],
                ["لَمْ يَلِدْ", "وَلَمْ يُولَدْ", "أَحَدٌ"],
                ["فِي", "جِيدِهَا", "حَبْلٌ", "مِن", "مَسَدٍ"],
                ["مَا", "أَغْنَى", "عَنْهُ", "مَالُهُ"]
            ],
            // Page 10: Waqaf (Stopping) Rules 1
            [
                ["نَسْتَعِينُ", "نَسْتَعِينْ", "مُسْتَقِيمٌ", "مُسْتَقِيمْ"],
                ["كِتَابٍ", "كِتَابْ", "حِسَابًا", "حِسَابَا"],
                ["رَحْمَةً", "رَحْمَهْ", "جَنَّةٍ", "جَنَّهْ"],
                ["أَحَدٌ", "أَحَدْ", "الصَّمَدُ", "الصَّمَدْ"]
            ],
            // Page 11: Sentence Practice 1 (At-Takathur)
            [
                ["أَلْهَاكُمُ", "التَّكَاثُرُ"],
                ["حَتَّىٰ", "زُرْتُمُ", "الْمَقَابِرَ"],
                ["كَلَّا", "سَوْفَ", "تَعْلَمُونَ"],
                ["ثُمَّ", "كَلَّا", "سَوْفَ", "تَعْلَمُونَ"]
            ],
            // Page 12: Sentence Practice 2 (Al-'Asr)
            [
                ["وَالْعَصْرِ", "إِنَّ", "الْإِنسَانَ", "لَفِي", "خُسْرٍ"],
                ["إِلَّا", "الَّذِينَ", "آمَنُوا", "وَعَمِلُوا"],
                ["الصَّالِحَاتِ", "وَتَوَاصَوْا", "بِالْحَقِّ"],
                ["وَتَوَاصَوْا", "بِالصَّبْرِ"]
            ]
        ],
        6: [
            // Page 1: Idgham Bigunnah (Nun Mati/Tanwin + Ya, Nun, Mim, Wau)
            [
                ["مَنْ يَقُولُ", "مَي يَقُولُ", "وُجُوهٌ يَوْمَئِذٍ"],
                ["مِنْ نِعْمَةٍ", "مِن نِّعْمَةٍ", "حِطَّةٌ نَغْفِرْ"],
                ["مِنْ مَسَدٍ", "مِم مَّسَدٍ", "صُحُفًا مُطَهَّرَةً"],
                ["مِنْ وَرَائِهِمْ", "مِو وَرَائِهِمْ", "أَبِي لَهَبٍ وَتَبَّ"]
            ],
            // Page 2: Idgham Bilagunnah (Nun Mati/Tanwin + Lam, Ro)
            [
                ["مِنْ لَدُنْكَ", "مِل لَّدُنْكَ", "هُدًى لِلْمُتَّقِينَ"],
                ["مِنْ رَبِّهِمْ", "مِر رَّبِّهِمْ", "عِيشَةٍ رَاضِيَةٍ"],
                ["لَئِنْ لَمْ", "لَئِل لَّمْ", "وَيْلٌ لِكُلِّ"],
                ["أَنْ رَآهُ", "أَر رَّآهُ", "رَءُوفٌ رَحِيمٌ"]
            ],
            // Page 3: Iqlab (Nun Mati/Tanwin + Ba)
            [
                ["مِنْ بَعْدِ", "مِم بَعْدِ", "أَنْبِئْهُمْ"],
                ["سَمِيعٌ بَصِيرٌ", "سَمِيعُم بَصِيرٌ", "يُنْبِتُ"],
                ["كِرَامٍ بَرَرَةٍ", "كِرَامِم بَرَرَةٍ", "أَمَدًا بَعِيدًا"],
                ["لَنَسْفَعًا بِالنَّاصِيَةِ", "عَلِيمٌ بِذَاتِ"]
            ],
            // Page 4: Ikhfa (Samar)
            [
                ["مِنْ دُونِ", "أَنْدَادًا", "كُنْتُمْ"],
                ["مَنْصُورًا", "أَنْزَلْنَا", "مِنْ طِينٍ"],
                ["رِيحًا صَرْصَرًا", "قَوْمًا ظَالِمِينَ", "شَيْءٍ قَدِيرٌ"],
                ["خَالِدًا فِيهَا", "كِرَامًا كَاتِبِينَ", "يَوْمًا ثَقِيلًا"]
            ],
            // Page 5: Mad Lazim (Panjang Berat)
            [
                ["الْحَاقَّةُ", "مَا", "الْحَاقَّةُ"],
                ["الطَّامَّةُ", "الصَّاخَّةُ", "دَابَةٍ"],
                ["وَلَا", "الضَّالِّينَ", "كّافَّةً"],
                ["أَتُحَاجُّونِّي", "قُلْ", "آللَّهُ", "أَذِنَ"]
            ],
            // Page 6: Tanda Waqaf (Berhenti)
            [
                ["مـ (Henti Lazim): إِنَّمَا يَسْتَجِيبُ الَّذِينَ يَسْمَعُون ۘ وَالْمَوْتَى"],
                ["لا (Dilarang Henti): الَّذِينَ تَتَوَفَّاهُمُ الْمَلَائِكَةُ طَيِّبِينَ ۙ يَقُولُونَ"],
                ["ج (Boleh Henti/Lanjut): نَحْنُ نَقُصُّ عَلَيْكَ نَبَأَهُم بِالْحَقِّ ۚ إِنَّهُمْ فِتْيَةٌ"],
                ["قلى (Lebih baik henti): قُلْ رَبِّي أَعْلَمُ بِعِدَّتِهِمْ مَا يَعْلَمُهُمْ إِلَّا قَلِيلٌ ۗ فَلَا"]
            ],
            // Page 7: Latihan Ayat (Ayat Kursi Part 1)
            [
                ["اللَّهُ", "لَا", "إِلَٰهَ", "إِلَّا", "هُوَ"],
                ["الْحَيُّ", "الْقَيُّومُ", "لَا", "تَأْخُذُهُ"],
                ["سِنَةٌ", "وَلَا", "نَوْمٌ", "لَهُ", "مَا"],
                ["فِي", "السَّمَاوَاتِ", "وَمَا", "فِي", "الْأَرْضِ"]
            ],
            // Page 8: Latihan Ayat (Ayat Kursi Part 2)
            [
                ["مَنْ", "ذَا", "الَّذِي", "يَشْفَعُ", "عِنْدَهُ"],
                ["إِلَّا", "بِإِذْنِهِ", "يَعْلَمُ", "مَا", "بَيْنَ"],
                ["أَيْدِيهِمْ", "وَمَا", "خَلْفَهُمْ", "وَلَا", "يُحِيطُونَ"],
                ["بِشَيْءٍ", "مِنْ", "عِلْمِهِ", "إِلَّا", "بِمَا", "شَاءَ"]
            ],
            // Page 9: Surah Al-Ikhlas
            [
                ["بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ"],
                ["قُلْ هُوَ اللَّهُ أَحَدٌ"],
                ["اللَّهُ الصَّمَدُ"],
                ["لَمْ يَلِدْ وَلَمْ يُولَدْ"],
                ["وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ"]
            ],
            // Page 10: Surah Al-Falaq
            [
                ["بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ"],
                ["قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ"],
                ["مِنْ شَرِّ مَا خَلَقَ"],
                ["وَمِنْ شَرِّ غَاسِقٍ إِذَا وَقَبَ"],
                ["وَمِنْ شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ"],
                ["وَمِنْ شَرِّ حَاسِدٍ إِذَا حَسَدَ"]
            ],
            // Page 11: Surah An-Nas
            [
                ["بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ"],
                ["قُلْ أَعُوذُ بِرَبِّ النَّاسِ", "مَلِكِ النَّاسِ"],
                ["إِلَٰهِ النَّاسِ", "مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ"],
                ["الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ"],
                ["مِنَ الْجِنَّةِ وَالنَّاسِ"]
            ]
        ]
    };

    const currentContent = iqroContents[level] || [];
    const totalPages = currentContent.length;
    const currentPageContent = currentContent[page - 1] || [];

    const handleNext = () => {
        if (page < totalPages) setPage(page + 1);
    };

    const handlePrev = () => {
        if (page > 1) setPage(page - 1);
    };

    const handleLevelChange = (l) => {
        setLevel(l);
        setPage(1);
    };

    return (
        <div className="space-y-6">
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <h1 className="text-2xl font-bold text-slate-800 flex items-center gap-2">
                        <BookOpen className="w-8 h-8 text-primary-600" />
                        Belajar Iqro
                    </h1>
                    <p className="text-slate-500 mt-1">Pilih jilid Iqro untuk mulai belajar.</p>
                </div>

                {/* Level Selector */}
                <div className="flex gap-2 bg-slate-100 p-1 rounded-lg overflow-x-auto">
                    {levels.map((l) => (
                        <button
                            key={l}
                            onClick={() => handleLevelChange(l)}
                            className={`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${level === l
                                ? 'bg-white text-primary-600 shadow-sm'
                                : 'text-slate-500 hover:text-slate-700 hover:bg-slate-200'
                                }`}
                        >
                            Jilid {l}
                        </button>
                    ))}
                </div>
            </div>

            {/* Content Area */}
            <div className="bg-white rounded-2xl shadow-sm border border-slate-100 min-h-[500px] flex flex-col">
                <div className="p-6 border-b border-slate-100 flex items-center justify-between">
                    <h2 className="text-xl font-bold text-slate-700">Materi Iqro Jilid {level}</h2>
                    <div className="flex items-center gap-2 bg-slate-100 px-3 py-1 rounded-full">
                        <span className="text-sm font-medium text-slate-600">Halaman {page} / {totalPages || 1}</span>
                    </div>
                </div>

                {/* Reading Content */}
                <div className="flex-1 flex flex-col items-center justify-center py-12 px-4">
                    {totalPages > 0 ? (
                        <div className="w-full max-w-4xl space-y-8">
                            {currentPageContent.map((line, lineIdx) => (
                                <div key={lineIdx} className="flex flex-wrap flex-row-reverse justify-center gap-8 md:gap-16">
                                    {line.map((char, charIdx) => {
                                        const isPlaying = playingChar?.line === lineIdx && playingChar?.char === charIdx;
                                        return (
                                            <div
                                                key={charIdx}
                                                onClick={() => handlePlayChar(char, lineIdx, charIdx)}
                                                className={`font-arabic text-5xl md:text-7xl transition-all cursor-pointer leading-relaxed select-none ${isPlaying
                                                    ? 'text-primary-600 scale-110 drop-shadow-md'
                                                    : 'text-slate-800 hover:text-primary-600 hover:scale-105'
                                                    }`}
                                            >
                                                {char}
                                            </div>
                                        );
                                    })}
                                </div>
                            ))}
                        </div>
                    ) : (
                        <div className="text-center text-slate-400 py-12">
                            <BookOpen className="w-16 h-16 mx-auto mb-4 opacity-20" />
                            <p className="text-lg">Konten Jilid {level} belum tersedia.</p>
                        </div>
                    )}
                </div>

                {/* Navigation Controls */}
                <div className="p-6 border-t border-slate-100 bg-slate-50/50 rounded-b-2xl">
                    <div className="flex items-center justify-between max-w-md mx-auto">
                        <button
                            onClick={handlePrev}
                            disabled={page === 1}
                            className="p-3 rounded-full hover:bg-white hover:shadow-md disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:shadow-none transition-all"
                        >
                            <ChevronRight className="w-6 h-6 text-slate-600 rotate-180" />
                        </button>

                        <button className="flex items-center gap-2 px-6 py-3 bg-primary-600 text-white rounded-full font-bold shadow-lg hover:bg-primary-700 hover:scale-105 transition-all active:scale-95">
                            <PlayCircle className="w-5 h-5" />
                            <span className="hidden md:inline">Dengar Halaman Ini</span>
                            <span className="md:hidden">Dengar</span>
                        </button>

                        <button
                            onClick={handleNext}
                            disabled={page === totalPages}
                            className="p-3 rounded-full hover:bg-white hover:shadow-md disabled:opacity-30 disabled:hover:bg-transparent disabled:hover:shadow-none transition-all"
                        >
                            <ChevronRight className="w-6 h-6 text-slate-600" />
                        </button>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default Iqro;
